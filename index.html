<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8"/>
    <title>FSharp.Text.Experimental.Transform
</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <meta name="description" content="A library used to parse and transform structured text"/>
    <meta name="author" content="Andrew Stevenson"/>

    <script src="https://code.jquery.com/jquery-1.8.0.js"></script>
    <script src="https://code.jquery.com/ui/1.8.23/jquery-ui.js"></script>
    <script src="https://netdna.bootstrapcdn.com/twitter-bootstrap/2.2.1/js/bootstrap.min.js"></script>
    <link href="https://netdna.bootstrapcdn.com/twitter-bootstrap/2.2.1/css/bootstrap-combined.min.css" rel="stylesheet"/>

    <link type="text/css" rel="stylesheet" href="/FSharp.Text.Experimental.Transform/content/style.css" />
    <script type="text/javascript" src="/FSharp.Text.Experimental.Transform/content/tips.js"></script>
    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="container">
      <div class="masthead">
        <ul class="nav nav-pills pull-right">
          <li><a href="http://fsharp.org">fsharp.org</a></li>
          <li><a href="http://github.com/aastevenson/FSharp.Text.Experimental.Transform">github page</a></li>
        </ul>
        <h3 class="muted"><a href="/FSharp.Text.Experimental.Transform/index.html">FSharp.Text.Experimental.Transform</a></h3>
      </div>
      <hr />
      <div class="row">
        <div class="span9" id="main">
          
<h1><a name="FSharp-Text-Experimental-Transform" class="anchor" href="#FSharp-Text-Experimental-Transform">FSharp.Text.Experimental.Transform</a></h1>
<div class="row">
  <div class="span1"></div>
  <div class="span6">
    <div class="well well-small" id="nuget">
      The FSharp.Text.Experimental.Transform library can be <a href="https://nuget.org/packages/FSharp.Text.Experimental.Transform">installed from NuGet</a>:
      <pre>PM> Install-Package FSharp.Text.Experimental.Transform</pre>
    </div>
  </div>
  <div class="span1"></div>
</div>
<p>This library provides F# 4.0 developers with a powerful way to parse and transform structured text
documents. At a high level, the library requires three inputs:</p>
<ol>
<li>A grammar</li>
<li>A set of transformation functions (unnecessary for parsing only)</li>
<li>A text file to process</li>
</ol>
<p>The library uses the grammar to parse the text file into a syntax tree, then the transformation functions are
applied to this syntax tree yielding a new tree. Finally, this new tree is unparsed back into text representing the
transformed document.</p>
<p>This library makes use of F#'s type provider feature. The GrammarProvider type provider treats the input
text file as data, and the grammar as a schema. Every nonterminal in the grammar becomes
a type emitted by the type provider.</p>
<h2><a name="Hello-World-Example" class="anchor" href="#Hello-World-Example">Hello World Example</a></h2>
<p>Let's start with a simple Hello World example. The goal here is to transform the input string "welcome world" into "hello world".
We start by writing a grammar that describes our language, then parse the input string, transform the syntax tree, and finally
unparse the tree back into a string.</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
<span class="l">5: </span>
<span class="l">6: </span>
<span class="l">7: </span>
<span class="l">8: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="k">open</span> <span onmouseout="hideTip(event, 'fs1', 1)" onmouseover="showTip(event, 'fs1', 1)" class="i">FSharp</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs2', 2)" onmouseover="showTip(event, 'fs2', 2)" class="i">Text</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs3', 3)" onmouseover="showTip(event, 'fs3', 3)" class="i">Experimental</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs4', 4)" onmouseover="showTip(event, 'fs4', 4)" class="i">Transform</span>

<span class="c">// specify the grammar</span>
[&lt;<span onmouseout="hideTip(event, 'fs5', 5)" onmouseover="showTip(event, 'fs5', 5)" class="t">Literal</span>&gt;]
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs6', 6)" onmouseover="showTip(event, 'fs6', 6)" class="i">grammar</span> <span class="o">=</span> <span class="s">&quot;&quot;&quot;</span>
<span class="s">        Program     :   Greeting &#39;world&#39;;</span>
<span class="s">        Greeting    :   &#39;welcome&#39; | &#39;hello&#39;;</span>
<span class="s">    &quot;&quot;&quot;</span> 
</code></pre></td>
</tr>
</table>
<p>Grammars can be defined in a separate text file or as string literals in the F# program. Grammars in string literals
are typically enclosed in triple-quotes to make formatting easier. All grammars must contain a rule named 'Program',
which represents the start symbol of the grammar. The 'Program' nonterminal above is defined as a greeting followed by
the literal <code>world</code>, and a greeting is defined as either <code>welcome</code> or <code>hello</code>.</p>
<p>With this grammar we can invoke the GrammarProvider type provider:</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="c">// pass the grammar to the type provider</span>
<span class="k">type</span> <span onmouseout="hideTip(event, 'fs7', 7)" onmouseover="showTip(event, 'fs7', 7)" class="t">HW</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs8', 8)" onmouseover="showTip(event, 'fs8', 8)" class="t">GrammarProvider</span><span class="o">&lt;</span><span onmouseout="hideTip(event, 'fs6', 9)" onmouseover="showTip(event, 'fs6', 9)" class="i">grammar</span><span class="o">&gt;</span>
</code></pre></td>
</tr>
</table>
<p>Next, we define a function that takes the grammar element type we wish to change (Greeting), tries to match it against
a pattern, and specifies a replacement Greeting if the match is found.</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="k">let</span> <span onmouseout="hideTip(event, 'fs9', 10)" onmouseover="showTip(event, 'fs9', 10)" class="f">welcomeToHello</span> (<span onmouseout="hideTip(event, 'fs10', 11)" onmouseover="showTip(event, 'fs10', 11)" class="i">inp</span><span class="o">:</span> <span onmouseout="hideTip(event, 'fs7', 12)" onmouseover="showTip(event, 'fs7', 12)" class="i">HW</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs11', 13)" onmouseover="showTip(event, 'fs11', 13)" class="t">Greeting</span>) <span class="o">=</span>
    <span class="k">match</span> <span onmouseout="hideTip(event, 'fs10', 14)" onmouseover="showTip(event, 'fs10', 14)" class="i">inp</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs12', 15)" onmouseover="showTip(event, 'fs12', 15)" class="f">TryMatch</span><span class="o">&lt;</span><span class="s">&quot;welcome&quot;</span><span class="o">&gt;</span>() <span class="k">with</span>
    | <span onmouseout="hideTip(event, 'fs13', 16)" onmouseover="showTip(event, 'fs13', 16)" class="p">Some</span> _ <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs7', 17)" onmouseover="showTip(event, 'fs7', 17)" class="t">HW</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs11', 18)" onmouseover="showTip(event, 'fs11', 18)" class="t">Greeting</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs14', 19)" onmouseover="showTip(event, 'fs14', 19)" class="f">Construct</span><span class="o">&lt;</span><span class="s">&quot;hello&quot;</span><span class="o">&gt;</span>()
    | <span onmouseout="hideTip(event, 'fs15', 20)" onmouseover="showTip(event, 'fs15', 20)" class="p">None</span>   <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs10', 21)" onmouseover="showTip(event, 'fs10', 21)" class="i">inp</span>
</code></pre></td>
</tr>
</table>
<p>Finally, we parse our input string, apply the transformation function defined above, and pretty print the resulting
parse tree.</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span onmouseout="hideTip(event, 'fs7', 22)" onmouseover="showTip(event, 'fs7', 22)" class="t">HW</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs16', 23)" onmouseover="showTip(event, 'fs16', 23)" class="f">ParseString</span> <span class="s">&quot;welcome world&quot;</span>                  <span class="c">// parse input string</span>
<span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs7', 24)" onmouseover="showTip(event, 'fs7', 24)" class="t">HW</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs17', 25)" onmouseover="showTip(event, 'fs17', 25)" class="t">Program</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs18', 26)" onmouseover="showTip(event, 'fs18', 26)" class="f">ApplyOnePass</span> <span onmouseout="hideTip(event, 'fs9', 27)" onmouseover="showTip(event, 'fs9', 27)" class="f">welcomeToHello</span>       <span class="c">// apply transformation function</span>
<span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs7', 28)" onmouseover="showTip(event, 'fs7', 28)" class="t">HW</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs19', 29)" onmouseover="showTip(event, 'fs19', 29)" class="f">Pretty</span>                                    <span class="c">// unparse to a string</span>
<span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs20', 30)" onmouseover="showTip(event, 'fs20', 30)" class="f">printfn</span> <span class="s">&quot;</span><span class="pf">%s</span><span class="s">&quot;</span>                                 <span class="c">// prints &quot;hello world&quot;</span>
</code></pre></td>
</tr>
</table>
<p>This example may seem like a convoluted way to do a simple text replacement, however the power of tree-based transformations
becomes apparent in <a href="tutorial.html">a more complex example</a>.</p>
<h2><a name="Samples-amp-documentation" class="anchor" href="#Samples-amp-documentation">Samples &amp; documentation</a></h2>
<p>The library comes with various documentation:</p>
<ul>
<li>The <a href="tutorial.html">tutorial</a> steps through a JSON transformation example, explaning the thought process at each step.</li>
<li>A discussion of <a href="parser.html">parsing</a> with this library, including a comparison with FParsec.</li>
<li>An <a href="api.html">API Reference</a> describing the various types and methods available through this type provider.</li>
<li><a href="idioms.html">Transformation idioms</a> for common transformation tasks.</li>
<li>How to write <a href="grammarsyntax.html">grammars</a> for your custom text formats.</li>
<li>The <a href="philosophy.html">design goals and philosophy</a> behind this library.</li>
<li>The current <a href="limitations.html">limitations</a> of this library.</li>
</ul>
<h2><a name="Contributing-and-copyright" class="anchor" href="#Contributing-and-copyright">Contributing and copyright</a></h2>
<p>The project is hosted on <a href="https://github.com/fsprojects/FSharp.Text.Experimental.Transform">GitHub</a> where you can <a href="https://github.com/fsprojects/FSharp.Text.Experimental.Transform/issues">report issues</a> and fork
the project. The library is available under Public Domain license, which allows modification and
redistribution for both commercial and non-commercial purposes. For more information see the
<a href="https://github.com/fsprojects/FSharp.Text.Experimental.Transform/blob/master/LICENSE.txt">License file</a> in the GitHub repository.</p>

<div class="tip" id="fs1">Multiple items<br />namespace FSharp<br /><br />--------------------<br />namespace Microsoft.FSharp</div>
<div class="tip" id="fs2">namespace FSharp.Text</div>
<div class="tip" id="fs3">namespace FSharp.Text.Experimental</div>
<div class="tip" id="fs4">namespace FSharp.Text.Experimental.Transform</div>
<div class="tip" id="fs5">Multiple items<br />type LiteralAttribute =<br />&#160;&#160;inherit Attribute<br />&#160;&#160;new : unit -&gt; LiteralAttribute<br /><br />Full name: Microsoft.FSharp.Core.LiteralAttribute<br /><br />--------------------<br />new : unit -&gt; LiteralAttribute</div>
<div class="tip" id="fs6">val grammar : string<br /><br />Full name: Index.grammar</div>
<div class="tip" id="fs7">type HW = GrammarProvider&lt;...&gt;<br /><br />Full name: Index.HW</div>
<div class="tip" id="fs8">type GrammarProvider<br /><br />Full name: FSharp.Text.Experimental.Transform.GrammarProvider</div>
<div class="tip" id="fs9">val welcomeToHello : inp:GrammarProvider&lt;...&gt;.Greeting -&gt; GrammarProvider&lt;...&gt;.Greeting<br /><br />Full name: Index.welcomeToHello</div>
<div class="tip" id="fs10">val inp : GrammarProvider&lt;...&gt;.Greeting</div>
<div class="tip" id="fs11">type Greeting =<br />&#160;&#160;inherit ParseTreeNode<br />&#160;&#160;member Chosen : Choice&lt;Unit,Unit&gt;<br />&#160;&#160;member ToString : unit -&gt; string<br />&#160;&#160;member TryMatch : unit -&gt; Option&lt;BindingType&gt;<br />&#160;&#160;member TryMatch,pattern=&quot;welcome&quot; : unit -&gt; Option&lt;BindingType1&gt;<br />&#160;&#160;static member Construct : unit -&gt; Greeting<br />&#160;&#160;static member Construct,pattern=&quot;hello&quot; : unit -&gt; Greeting<br /><br />Full name: FSharp.Text.Experimental.Transform.GrammarProvider,Grammar=&quot;<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Program     :   Greeting &#39;world&#39;;<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Greeting    :   &#39;welcome&#39; | &#39;hello&#39;;<br />&#160;&#160;&#160;&#160;&quot;.Greeting<br /><em><br /><br />This type represents the grammar nonterminal definition (&#39;welcome&#39; | &#39;hello&#39;)</em></div>
<div class="tip" id="fs12">GrammarProvider&lt;...&gt;.Greeting.TryMatch() : Option&lt;GrammarTypeMethods.BindingType&gt;<br /><em><br /><br />&lt;summary&gt;<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&lt;para&gt;Tries to match this object with a parse pattern. The parse pattern is specified by a static string parameter that <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;must be a valid &#39;Greeting&#39;. This pattern may contain wildcards of the form var$Type where &#39;var&#39; is a variable<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;identifier and &#39;Type&#39; is a grammar nonterminal or token class. If a match is found, the pattern is unified with this<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;object&#39;s parse tree and each wildcard variable will be bound to its corresponding subtree. Anonymous variables are<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;specified by omitting the variable identifier (e.g. $Type).&lt;/para&gt;<br /><br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&lt;para&gt;Returns Some(BindingType) if a match exists, otherwise returns None. The BindingType class gives access to <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;wildcard variables bound in the pattern.&lt;/para&gt;<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&lt;para&gt;Sample use:&lt;/para&gt;<br /><br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&lt;para&gt;match myGreeting.TryMatch&amp;lt;&quot;$Greeting&quot;&amp;gt;() with &lt;/para&gt;<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&lt;para&gt;| Some b -&amp;gt; printfn &quot;Match found&quot; &lt;/para&gt;<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&lt;para&gt;| None -&amp;gt; printfn &quot;No match&quot; &lt;/para&gt;<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&lt;/summary&gt;<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</em></div>
<div class="tip" id="fs13">union case Option.Some: Value: &#39;T -&gt; Option&lt;&#39;T&gt;</div>
<div class="tip" id="fs14">GrammarProvider&lt;...&gt;.Greeting.Construct() : GrammarProvider&lt;...&gt;.Greeting<br /><em><br /><br />&lt;summary&gt;<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&lt;para&gt;Constructs a new Greeting object based on a parse pattern. The parse pattern is specified by a static string parameter that <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;may contain holes of the form $Type where &#39;Type&#39; is a grammar nonterminal or token class, and which are filled in by the <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;values provided in this method&#39;s parameters.&lt;/para&gt;<br /><br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&lt;para&gt;Returns a new Greeting object&lt;/para&gt;</em></div>
<div class="tip" id="fs15">union case Option.None: Option&lt;&#39;T&gt;</div>
<div class="tip" id="fs16">GrammarProvider&lt;...&gt;.ParseString(InputString: string) : GrammarProvider&lt;...&gt;.Program<br /><em><br /><br />Parses an input string according to the grammar. Returns a Program object representing a parse tree of the input.</em></div>
<div class="tip" id="fs17">type Program =<br />&#160;&#160;inherit ParseTreeNode<br />&#160;&#160;member Contains : item: Greeting -&gt; bool<br />&#160;&#160;member FindAllGreetings : unit -&gt; List&lt;Greeting&gt; + 1 overload<br />&#160;&#160;member FindAllGreetingsMatching : unit -&gt; List&lt;BindingType&gt;<br />&#160;&#160;member Greeting : Greeting<br />&#160;&#160;member ToString : unit -&gt; string<br />&#160;&#160;member TryFindGreeting : unit -&gt; Option&lt;BindingType&gt;<br />&#160;&#160;member TryMatch : unit -&gt; Option&lt;BindingType&gt;<br />&#160;&#160;static member ApplyOnePass : transformer: Greeting -&gt; Greeting -&gt; Program -&gt; Program + 1 overload<br />&#160;&#160;static member ApplyRecursively : transformer: Greeting -&gt; Greeting -&gt; Program -&gt; Program + 1 overload<br />&#160;&#160;...<br /><br />Full name: FSharp.Text.Experimental.Transform.GrammarProvider,Grammar=&quot;<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Program     :   Greeting &#39;world&#39;;<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Greeting    :   &#39;welcome&#39; | &#39;hello&#39;;<br />&#160;&#160;&#160;&#160;&quot;.Program<br /><em><br /><br />This type represents the grammar nonterminal definition (Greeting &#39;world&#39;)</em></div>
<div class="tip" id="fs18">GrammarProvider&lt;...&gt;.Program.ApplyOnePass(transformer: GrammarProvider&lt;...&gt;.Greeting -&gt; GrammarProvider&lt;...&gt;.Greeting) : GrammarProvider&lt;...&gt;.Program -&gt; GrammarProvider&lt;...&gt;.Program<br /><em><br /><br />Performs one pass over the parse tree, applying the given transformation function to each &#39;Greeting&#39; element. <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Nested Greeting elements are not transformed because this operation is not recursively applied to replacements.<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;This operation is guaranteed to return.</em></div>
<div class="tip" id="fs19">GrammarProvider&lt;...&gt;.Pretty(parseTree: GrammarProvider&lt;...&gt;.Greeting) : string<br /><em><br /><br />Unparses the given parse tree into a prettily formatted string</em><br />GrammarProvider&lt;...&gt;.Pretty(parseTree: GrammarProvider&lt;...&gt;.Program) : string<br /><em><br /><br />Unparses the given parse tree into a prettily formatted string</em></div>
<div class="tip" id="fs20">val printfn : format:Printf.TextWriterFormat&lt;&#39;T&gt; -&gt; &#39;T<br /><br />Full name: Microsoft.FSharp.Core.ExtraTopLevelOperators.printfn</div>

        </div>
        <div class="span3">
          <img src="/FSharp.Text.Experimental.Transform/img/logo.png" alt="F# Project" style="width:150px;margin:10px" />  
          <ul class="nav nav-list" id="menu" style="margin-top: 20px;">
            <li class="nav-header">FSharp.Text.Experimental.Transform</li>
            <li><a href="/FSharp.Text.Experimental.Transform/index.html">Home page</a></li>
            <li class="divider"></li>
            <li><a href="http://nuget.org/packages/FSharp.Text.Experimental.Transform">Get Library via NuGet</a></li>
            <li><a href="http://github.com/aastevenson/FSharp.Text.Experimental.Transform">Source Code on GitHub</a></li>
            <li><a href="/FSharp.Text.Experimental.Transform/license.html">License</a></li>
            <li><a href="/FSharp.Text.Experimental.Transform/release-notes.html">Release Notes</a></li>
            
            <li class="nav-header">Getting started</li>
            <li><a href="/FSharp.Text.Experimental.Transform/tutorial.html">Sample tutorial</a></li>

            <li class="nav-header">Documentation</li>
            <li><a href="/FSharp.Text.Experimental.Transform/reference/index.html">API Reference</a></li>
          </ul>
        </div>
      </div>
    </div>
    <a href="http://github.com/aastevenson/FSharp.Text.Experimental.Transform"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_gray_6d6d6d.png" alt="Fork me on GitHub"/></a>
  </body>
  </html>
